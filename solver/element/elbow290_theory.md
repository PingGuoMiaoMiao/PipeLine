# ELBOW290 弯管单元理论说明

## 1. 弯管几何建模

### 1.1 基本几何参数

弯管单元由以下几何参数定义：
- **曲率半径 R**: 弯管的曲率半径（从中心线到曲率中心的距离）
- **角度 θ**: 弯管的弯曲角度（从起始到结束的角度）
- **外径 D**: 管道外径
- **壁厚 t**: 管道壁厚

### 1.2 局部坐标系

对于弯管单元，建立以下局部坐标系：

1. **全局坐标系 (X, Y, Z)**: 整体结构坐标系
2. **弯管局部坐标系**:
   - **s轴**: 沿弯管中心线的弧长坐标（0 ≤ s ≤ R·θ）
   - **φ轴**: 环向角度坐标（0 ≤ φ < 2π）
   - **n轴**: 径向坐标（指向壁厚方向）

## 2. 自由度定义

ELBOW290单元在PIPE288的6个标准自由度基础上，增加了截面变形自由度：

### 2.1 标准自由度（每个节点6个）
- UX, UY, UZ: 平移自由度
- ROTX, ROTY, ROTZ: 转动自由度

### 2.2 截面变形自由度（椭圆化和翘曲）

环向变形采用傅里叶级数展开，使用低阶项近似：

**椭圆化 (Ovalization)**:
- 使用cos(2φ)和sin(2φ)项描述截面椭圆化变形
- 对应自由度：δ_2c, δ_2s（2阶余弦和正弦项）

**翘曲 (Warping)**:
- 使用cos(3φ)和sin(3φ)项描述截面翘曲变形
- 对应自由度：δ_3c, δ_3s（3阶余弦和正弦项）

因此，每个节点有：**6 + 4 = 10个自由度**

## 3. 环向傅里叶级数形函数

### 3.1 位移场展开

环向位移场用傅里叶级数表示：

\[
u_\phi(\phi) = \sum_{n=0}^{\infty} \left[ a_n \cos(n\phi) + b_n \sin(n\phi) \right]
\]

对于ELBOW290，通常取前几项：
- n=0: 刚体位移（已包含在标准自由度中）
- n=1: 截面刚体转动（已包含在ROTZ中）
- n=2: 椭圆化（Ovalization）
- n=3: 翘曲（Warping）
- n≥4: 高阶项（通常忽略）

### 3.2 形函数

对于n阶项，形函数为：
- \( N_n^c(\phi) = \cos(n\phi) \)
- \( N_n^s(\phi) = \sin(n\phi) \)

## 4. 弯管刚度矩阵

### 4.1 基本假设

1. **细长弯管假设**: R/D >> 1（曲率半径远大于管径）
2. **薄壁假设**: t/D << 1（壁厚远小于管径）
3. **小变形假设**: 变形相对于几何尺寸很小

### 4.2 刚度矩阵组成

弯管单元的刚度矩阵包括：

1. **轴向和弯曲刚度**: 与直管类似，但考虑曲率影响
2. **扭转刚度**: 考虑弯管曲率的影响
3. **椭圆化刚度**: 与弯管曲率、内压相关
4. **翘曲刚度**: 高阶变形刚度项

### 4.3 椭圆化刚度

椭圆化刚度主要来自：
- **几何刚度**: 由曲率引起的几何非线性
- **内压刚度**: 内压对椭圆化的影响
- **材料刚度**: 材料抵抗椭圆化变形的能力

对于简化的线性模型，椭圆化刚度可以近似为：

\[
K_{oval} \approx \frac{E t^3}{R^2}
\]

## 5. 载荷处理

### 5.1 内压作用

内压在弯管中会产生：
- **轴向力**: 与直管相同
- **环向力**: 产生椭圆化趋势
- **径向力**: 对截面变形的影响

### 5.2 弯矩作用

弯矩在弯管中会产生：
- **弯曲变形**: 标准弯曲响应
- **椭圆化**: 弯矩会引起截面椭圆化
- **翘曲**: 高阶变形

## 6. 简化实现策略

对于初步实现，可以采用以下简化：

1. **忽略高阶项**: 仅考虑2阶（椭圆化）和3阶（翘曲）项
2. **线性化**: 采用线性刚度矩阵，忽略几何非线性
3. **均匀截面**: 假设截面沿弧长不变
4. **小曲率**: 假设R >> D，可以使用直管的刚度项加修正项

## 7. VTK输出格式

为了显示椭圆化趋势，需要将环向自由度扩展为三维曲面：

1. **基础几何**: 弯管中心线（由节点坐标确定）
2. **截面生成**: 在每个积分点/节点处生成截面
3. **椭圆化变形**: 根据椭圆化自由度调整截面形状
4. **曲面重建**: 使用四边形面片连接相邻截面

### 7.1 截面生成

对于环向角度φ，变形后的径向位移：

\[
\Delta r(\phi) = \delta_2^c \cos(2\phi) + \delta_2^s \sin(2\phi) + \delta_3^c \cos(3\phi) + \delta_3^s \sin(3\phi)
\]

变形后的截面坐标：
\[
x(\phi) = (R_{mean} + \Delta r(\phi)) \cos(\phi)
\]
\[
y(\phi) = (R_{mean} + \Delta r(\phi)) \sin(\phi)
\]

其中R_mean是平均半径。

